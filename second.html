<!DOCTYPE html>
<html>
  <head>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="styles.css" />
  </head>
  <body>
    <form>
      <h2 style="color: #fff; margin-bottom: 20px">Google Spreadsheet Data</h2>
      <div style="text-align: center">
        <label for="FYCS">FYCS:</label>
        <input type="text" id="FYCS" name="FYCS" /><br />
        <label for="SYCS">SYCS:</label>
        <input type="text" id="SYCS" name="SYCS" /><br />
        <label for="TYCS">TYCS:</label>
        <input type="text" id="TYCS" name="TYCS" /><br />
        <button type="button" onclick="saveValues()">Save</button>
        <button type="button" onclick="loadValues()">Load Values</button>
      </div>
    </form>
    <script>
      function saveValues() {
        localStorage.setItem("FYCS", document.getElementById("FYCS").value);
        localStorage.setItem("SYCS", document.getElementById("SYCS").value);
        localStorage.setItem("TYCS", document.getElementById("TYCS").value);
      }

      function loadValues() {
        document.getElementById("FYCS").value =
          localStorage.getItem("FYCS") || "";
        document.getElementById("SYCS").value =
          localStorage.getItem("SYCS") || "";
        document.getElementById("TYCS").value =
          localStorage.getItem("TYCS") || "";
      }

      async function fetchSheetData(sheetId) {
        const apiKey = "YOUR_GOOGLE_SHEETS_API_KEY"; // Replace with your API key
        const range = "Sheet1!A1:D10"; // Adjust the range as needed

        try {
          const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
          );
          const data = await response.json();
          displaySheetData(data.values);
        } catch (error) {
          console.error("Error fetching data from Google Sheets:", error);
        }
      }

      function displaySheetData(data) {
        // Example: Display data in the first input field (FYCS)
        if (data && data.length > 0) {
          document.getElementById("FYCS").value = data[0][0]; // Adjust to display relevant data
        }
      }

      function displaySheetValue() {
        const urlParams = new URLSearchParams(window.location.search);
        const sheetValue = urlParams.get("sheet_value");
        if (sheetValue) {
          fetchSheetData(sheetValue);
        }
      }

      window.onload = function () {
        loadValues();
        displaySheetValue();
      };
    </script>
  </body>
</html>
